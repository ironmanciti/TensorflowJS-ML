<!DOCTYPE html>
<html lang="en">

<head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"> </script>
    <script>
        tf.backend(); //Get current backend
        console.log(tf.getBackend()); //현재의 backend name (cpu, webgl, etc) 반환

        async function doTraining(model) {
             return  await model.fit(xs, ys,
                    {
                        epochs: 10,
                        callbacks: {
                            onEpochEnd: async (epoch, logs) => {
                                console.log("Epoch:"
                                    + epoch
                                    + "Loss:"
                                    + logs.loss);
                            }
                        }
                    });
        }

        //model 선언
        const model = tf.sequential()
        model.add(tf.layers.dense({ units: 1, inputShape: [1] }));
        model.compile({ loss: 'meanSquaredError', optimizer: "sgd" })
        model.summary()
        //Data 생성 : y = 2*x + 1
        const xs = tf.tensor2d([-1.0, 0.0, 1.0, 2.0, 3.0, 4.0], [6, 1])
        const ys = tf.tensor2d([-1.0, 1.0, 3.0, 5.0, 7.0, 9.0], [6, 1])
        //model 학습
        doTraining(model).then(() => {
            alert(model.predict(tf.tensor2d([10], [1, 1])));
        })

    </script>
    <title>Document</title>
</head>

<body>
    <h1>First Model</h1>
    <h3>기본 개념 check</h3>
    <ol>
        <li>synchronous / asynchronous</li>
        <li>what is model ?</li>
        <li>model.fit()</li>
        <li>epoch</li>
        <li>model.compile()</li>
        <li>loss / meanSquaredError</li>
        <li>sgd(Stochastic Gradient Descent)</li>
        <li>tf.tensor2d</li>
        <li>mode.predict()</li>
    </ol>
</body>

</html>


